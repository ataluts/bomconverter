# bomconverter
Creating components database from Altium Designer project, schematics and BoM files and exporting it to different output formats.

# Назначение
Автоматизированное создание перечня элементов (ПЭ3), списка закупки компонентов (СК) и спецификации (СП) из проекта Altium Designer. 

# Описание:
Суть работы программы сводится к тому чтобы из проекта Altium Designer получить информацию о компонентах и о самом проекте, затем свести эту информацию в стандартизованную базу данных и уже из этой базы экспортировать данные в требуемый тип документа с требуемым форматированием. Проект сделан модульно чтобы импорт, парсинг, сборка и экспорт были максимально независимы друг от друга. Чтобы каждый схемотехник мог написать свой парсер под свой формат ведения схемы при этом экспорт задавался общепринятыми на предприятии стандартами и мог спокойно сопровождаться соответствующими сотрудниками без задалбывания схемотехника.

# Краткая суть работы
Всё крутится вокруг базы данных. Ключевым моментом является её заполнение, а каким именно образом уже возможны варианты.
Можно скармливать программе либо файл проекта в котором все данные подлинкованы (что предпочтительно) либо BoM-файлы и данные основной надписи по отдельности.
В случае работы с проектом AD достаточно указать только адрес самого файла. Программа запускает импортёр проекта AD, который берёт на себя все технические сложности чтения проекта и составляет из него соответсвующий объект. Далее созданный объект проекта перекидывается в парсер конкретного схемотехника который знает как правильно вытащить данные из проекта и выдаёт список BoM-файлов и данные об "основной надписи". (Особенность конкретно моего парсера проекта заключается в том что BoM файлы должны быть добавлены в проект, быть с расширением "csv" и иметь префикс "bom").

Далее обрабатывается каждый BoM-файл из заданного списка. Вначале импортёр открывает BoM-файл и составляет из него соответствующий объект. Затем этот объект передаётся в парсер схемотехника который знает как из представленных данных правильно сформировать базу данных компонентов (попутно проверив всё на возможные ошибки). (Особенность конкретно моего парсера BoM заключается в том что при экспорте из AD не должно быть группировки компонентов - то есть каждый элемент должен находится в отдельной строке).

После получения базы данных компонентов происходит трансляция имён производителей по словарю, что позволяет привести разные вариации записи имён к единообразию (что также полезно в случаях изменения имён когда один производитель покупает другого).
Далее для каждого типа экспорта соответствующим модулем происходит сборка соответсвующего объекта после чего этот объект передаётся в требуемый экспортёр который производит запись данных в нужный формат. Для экспорта в PDF необходимо наличие установленного MiKTeX (писалось под версией 20.11).
В отдельный модуль выделена сборка строк для ПЭ3 и СП (по ЕСКД или по любому-другому формату) которая собирает поля из параметров компонентов в базе данных.
